{% extends "base.html" %}

{% block title %}Editar Perfil - Mingleoo.com{% endblock %}

{% block content %}
<h1>Editar Perfil</h1>

<form action="/profile" method="POST" enctype="multipart/form-data">

    <div class="card">
        <h2>Sobre Mim</h2>
        <textarea name="bio" rows="4" placeholder="Escreva algo sobre voc√™...">{{ user.bio }}</textarea>
    </div>

    <div class="card">
        <h2>Avatar</h2>
        <p>Fa√ßa upload de uma imagem ou cole uma URL para seu avatar.</p>
        <input type="file" name="avatar_file" accept="image/*">
        <input type="text" name="avatar_url_input" placeholder="Ou cole a URL de uma imagem aqui" value="{{ user.avatar_url if user.avatar_url and not user.avatar_url.startswith('/static/uploads/') else '' }}">
        {% if user.avatar_url %}
            <img src="{{ user.avatar_url }}" alt="Seu avatar" style="max-width: 100px; margin-top: 10px; border-radius: 50%;">
        {% endif %}
    </div>

    <div class="card">
        <h2>Banner de Fundo</h2>
        <p>Fa√ßa upload de uma imagem ou cole uma URL para seu banner.</p>
        <input type="file" name="banner_file" accept="image/*">
        <input type="text" name="banner_url_input" placeholder="Ou cole a URL de uma imagem aqui" value="{{ user.banner_url if user.banner_url and not user.banner_url.startswith('/static/uploads/') else '' }}">
        {% if user.banner_url %}
            <img src="{{ user.banner_url }}" alt="Seu banner" style="max-width: 100%; margin-top: 10px; border-radius: 8px;">
        {% endif %}
    </div>

    <div class="card">
        <h2>Cor Principal do Perfil</h2>
        <p>Escolha uma cor para personalizar alguns elementos do seu perfil.</p>
        <input type="color" name="profile_color" value="{{ user.profile_color }}">
    </div>

    <div class="card">
        <h2>Cor de Fundo do Perfil</h2>
        <p>Escolha uma cor para o fundo do seu perfil.</p>
        <input type="color" name="background_color" value="{{ user.background_color }}">
    </div>

    <div class="card">
        <h2>Informa√ß√µes Pessoais</h2>
        <div>
            <label for="age">Idade:</label>
            <input type="number" id="age" name="age" value="{{ user.age }}" min="1" max="150">
        </div>
        <div>
            <label for="nationality">Nacionalidade:</label>
            <select id="nationality" name="nationality">
                <option value="">Selecione...</option>
                {% for country in countries %}
                    <option value="{{ country }}" {% if user.nationality == country %}selected{% endif %}>{{ country }}</option>
                {% endfor %}
            </select>
        </div>
        <div>
            <label for="gender">G√™nero:</label>
            <select id="gender" name="gender">
                <option value="">Selecione...</option>
                <option value="Masculino" {% if user.gender == "Masculino" %}selected{% endif %}>Masculino</option>
                <option value="Feminino" {% if user.gender == "Feminino" %}selected{% endif %}>Feminino</option>
                <option value="N√£o Bin√°rio" {% if user.gender == "N√£o Bin√°rio" %}selected{% endif %}>N√£o Bin√°rio</option>
                <option value="Outro" {% if user.gender == "Outro" %}selected{% endif %}>Outro</option>
            </select>
        </div>
        <div>
            <label for="sexuality">Sexualidade:</label>
            <input type="text" id="sexuality" name="sexuality" value="{{ user.sexuality or '' }}" placeholder="Ex: Heterossexual, Bissexual, Outro">
        </div>
    </div>

<div class="card">
    <h2>Se√ß√µes Personalizadas</h2>
    <div id="sections-container">
        {% for section in user_sections %}
        <div class="section">
            <input type="text" name="section_title" placeholder="T√≠tulo da se√ß√£o" value="{{ section[0] }}">
            <textarea name="section_content" rows="3" placeholder="Conte√∫do da se√ß√£o">{{ section[1] }}</textarea>
            <button type="button" onclick="this.parentNode.remove()">Remover</button>
        </div>
        {% endfor %}
    </div>
    <button type="button" class="add-btn" onclick="addSection()">Adicionar Se√ß√£o</button>
</div>


    <div class="card">
        <h2>Coloque seus gostos!</h2>
        <div id="tags-container">
            {% for tag in user_tags %}
            <div class="tag">
                <input type="text" name="tags" value="{{ tag }}">
                <button type="button" onclick="this.parentNode.remove()">Remover</button>
            </div>
            {% endfor %}
        </div>
        <button type="button" class="add-btn" onclick="addTag()">Adicionar hashtag</button>
    </div>

    

    <div class="card">
        <h2>Links de Contato</h2>
        <p>Para adicionar um link coloque NomePlataforma|URL</p>
        <div id="links-container">
            {% for link in user_links %}
            <div class="link">
                <input type="text" name="links" value="{{ link[0] }}|{{ link[1] }}">
                <button type="button" onclick="this.parentNode.remove()">Remover</button>
            </div>
            {% endfor %}
        </div>
        <button type="button" class="add-btn" onclick="addLink()">Adicionar link</button>
    </div>

    <div class="card" style="text-align:center;">
        <button type="submit">üíæ Salvar Perfil</button>
    </div>

    

</form>

<script>
function addTag() {
    const container = document.getElementById("tags-container");
    const div = document.createElement("div");
    div.className = "tag";
    div.innerHTML = `<input type="text" name="tags" placeholder="#exemplo">
                     <button type="button" onclick="this.parentNode.remove()">Remover</button>`;
    container.appendChild(div);
}

function addLink() {
    const container = document.getElementById("links-container");
    const div = document.createElement("div");
    div.className = "link";
    div.innerHTML = `<input type="text" name="links" placeholder="Discord|https://discord.com/...">
                     <button type="button" onclick="this.parentNode.remove()">Remover</button>`;
    container.appendChild(div);
}

function addSection() {
    const container = document.getElementById("sections-container");
    const div = document.createElement("div");
    div.className = "section";
    div.innerHTML = `
        <input type="text" name="section_title" placeholder="T√≠tulo da se√ß√£o">
        <textarea name="section_content" rows="3" placeholder="Conte√∫do da se√ß√£o"></textarea>
        <button type="button" onclick="this.parentNode.remove()">Remover</button>
    `;
    container.appendChild(div);
}

</script>
{% endblock %}
